# PyGWalker02.py
import pandas as pd
import pygwalker as pyg

# 建立範例 DataFrame
# data = {
#     "產品": ["A", "B", "C", "D" , "A", "B", "C", "D", "D", "C", "A", "B", "A","D" , "B" , "C"],
#     "銷售量": [100, 150, 80, 200, 100, 150, 80, 200, 200, 80, 100, 150 , 120 , 250, 300 , 140],
#     "區域": ["北部", "中部", "南部", "東部", "北部", "中部", "南部", "東部", "北部", "中部", "南部", "東部" , "北部" , "中部" , "南部","東部"],
#     "月份": ["一月", "一月", "一月", "一月", "二月", "二月", "二月", "二月", "三月", "三月", "三月", "三月" , "一月" , "二月" , "三月","三月"]
# }

data = [
    # 一月｜北部
    {"月份": "一月", "區域": "北部", "產品": "A", "銷售量": 120},
    {"月份": "一月", "區域": "北部", "產品": "B", "銷售量": 170},
    {"月份": "一月", "區域": "北部", "產品": "C", "銷售量": 90},
    {"月份": "一月", "區域": "北部", "產品": "D", "銷售量": 220},

    # 一月｜中部
    {"月份": "一月", "區域": "中部", "產品": "A", "銷售量": 100},
    {"月份": "一月", "區域": "中部", "產品": "B", "銷售量": 150},
    {"月份": "一月", "區域": "中部", "產品": "C", "銷售量": 80},
    {"月份": "一月", "區域": "中部", "產品": "D", "銷售量": 200},

    # 一月｜南部
    {"月份": "一月", "區域": "南部", "產品": "A", "銷售量": 95},
    {"月份": "一月", "區域": "南部", "產品": "B", "銷售量": 140},
    {"月份": "一月", "區域": "南部", "產品": "C", "銷售量": 70},
    {"月份": "一月", "區域": "南部", "產品": "D", "銷售量": 185},

    # 一月｜東部
    {"月份": "一月", "區域": "東部", "產品": "A", "銷售量": 110},
    {"月份": "一月", "區域": "東部", "產品": "B", "銷售量": 160},
    {"月份": "一月", "區域": "東部", "產品": "C", "銷售量": 85},
    {"月份": "一月", "區域": "東部", "產品": "D", "銷售量": 210},

    # 二月｜北部
    {"月份": "二月", "區域": "北部", "產品": "A", "銷售量": 135},
    {"月份": "二月", "區域": "北部", "產品": "B", "銷售量": 185},
    {"月份": "二月", "區域": "北部", "產品": "C", "銷售量": 105},
    {"月份": "二月", "區域": "北部", "產品": "D", "銷售量": 235},

    # 二月｜中部
    {"月份": "二月", "區域": "中部", "產品": "A", "銷售量": 115},
    {"月份": "二月", "區域": "中部", "產品": "B", "銷售量": 165},
    {"月份": "二月", "區域": "中部", "產品": "C", "銷售量": 95},
    {"月份": "二月", "區域": "中部", "產品": "D", "銷售量": 215},

    # 二月｜南部
    {"月份": "二月", "區域": "南部", "產品": "A", "銷售量": 105},
    {"月份": "二月", "區域": "南部", "產品": "B", "銷售量": 155},
    {"月份": "二月", "區域": "南部", "產品": "C", "銷售量": 85},
    {"月份": "二月", "區域": "南部", "產品": "D", "銷售量": 195},

    # 二月｜東部
    {"月份": "二月", "區域": "東部", "產品": "A", "銷售量": 125},
    {"月份": "二月", "區域": "東部", "產品": "B", "銷售量": 175},
    {"月份": "二月", "區域": "東部", "產品": "C", "銷售量": 100},
    {"月份": "二月", "區域": "東部", "產品": "D", "銷售量": 225},

    # 三月｜北部
    {"月份": "三月", "區域": "北部", "產品": "A", "銷售量": 150},
    {"月份": "三月", "區域": "北部", "產品": "B", "銷售量": 200},
    {"月份": "三月", "區域": "北部", "產品": "C", "銷售量": 120},
    {"月份": "三月", "區域": "北部", "產品": "D", "銷售量": 260},

    # 三月｜中部
    {"月份": "三月", "區域": "中部", "產品": "A", "銷售量": 130},
    {"月份": "三月", "區域": "中部", "產品": "B", "銷售量": 180},
    {"月份": "三月", "區域": "中部", "產品": "C", "銷售量": 110},
    {"月份": "三月", "區域": "中部", "產品": "D", "銷售量": 240},

    # 三月｜南部
    {"月份": "三月", "區域": "南部", "產品": "A", "銷售量": 120},
    {"月份": "三月", "區域": "南部", "產品": "B", "銷售量": 170},
    {"月份": "三月", "區域": "南部", "產品": "C", "銷售量": 100},
    {"月份": "三月", "區域": "南部", "產品": "D", "銷售量": 230},

    # 三月｜東部
    {"月份": "三月", "區域": "東部", "產品": "A", "銷售量": 140},
    {"月份": "三月", "區域": "東部", "產品": "B", "銷售量": 190},
    {"月份": "三月", "區域": "東部", "產品": "C", "銷售量": 115},
    {"月份": "三月", "區域": "東部", "產品": "D", "銷售量": 250},
]
df = pd.DataFrame(data)

# 啟動 PyGWalker 互動視覺化
# spec 參數可以指定一個檔案路徑來儲存/載入圖表配置
# 第一次執行時,請在 UI 中建立圖表,然後點擊儲存按鈕
# 之後執行時會自動載入之前儲存的配置

walker = pyg.walk(df)
